<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Userinterface</title>
</head>
<script src="/socket.io/socket.io.js"></script>
<script>
    let socket = io()
</script>
<body>
    <div id="loginblock">
        <p>Entrez un username pour pouvoir envoyer des messages</p>
        <input id='username' type="text" placeholder="Entrez votre username desire">
        <button onclick="Postusername">Submit</button>
    </div>
    <div id="chatsection" style="border-style: solid; width: 70%; height: 60vh; position: center">
        <ol id ="messagelist"></ol>
    </div>
    <div id="chatbox" style="border-style: solid; height: 20vh; width: 70%">
        <input id="chatinputs" type="text" style="width: 80%; height: 80%">
        <button id="msgbutton" style="float: right; height: 80%; width: 15%;" disabled>Envoyer</button>
    </div>
</body>
</html>
<script>
    let idcounter = 0;
    let socket = io.connect("http://localhost:3000");
    function Postusername() {
        let usernametopost = document.getElementById('username').value;
        if (usernametopost == '')
        {
            alert('Invalid username, cant be blank')
        }
        else{
            let init = {
                method: 'POST',
                headers: {
                    Accept: 'application/json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({username: usernametopost, id: idcounter})
            }
            fetch('http://localhost:8080/postusername',init).then();
            idcounter ++;
            let button = document.getElementById('msgbutton');
            button.enable()

        }
    }
    function emitmessage(message) {
        socket.emit('chatmessage',message)

    }
</script>